---
title: "gDRtestData"
author: "gDR team"
output: BiocStyle::html_document
vignette: >
  %\VignetteIndexEntry{gDRtestData}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r, echo=FALSE}
library(gDRtestData)
```

# Overview

The `gDRtestData` package is intended to store and generate example data that can be used through the `gDR` suite.

# Use Cases

## Synthetic data generation

Since `gDR`is a computational suite for drug response data from any experiment, a synthetic dataset is also needed for testing and exploration purposes. 

The basis of everything are two functions to generate the synthetic sets of cell lines and drugs.

```{r}
cell_lines <- create_synthetic_cell_lines()

drugs <- create_synthetic_drugs()
```

These base sets can be extended with additional information.

1. Replicates

```{r eval=FALSE}
cl_rep <- add_data_replicates(cell_lines)
head(cl_rep)
```

2. Concentration

```{r eval=FALSE}
cl_con <- add_concentration(cell_lines)
head(cl_con)
```

Or the user can do both with one function (for single-agent):

```{r eval=FALSE}
df_layout <- prepareData(cell_lines, drugs)
head(df_layout)
```

Additional, the user may fill the full response data with the day 0 part

```{r eval=FALSE}
df_merged <- prepareData(cell_lines[seq_len(2), ], drugs[seq_len(4), ])
df_merged$Duration <- 72
df_merged$ReadoutValue <- 0
df_merged_with_Day0 <- add_day0_data(df_merged)
head(df_merged_with_Day0)
```

In further step the user may generate set of synthetic results:

1. Hill coefficient
```{r}
hill <- generate_hill_coef(cell_lines, drugs) 
```

2. EC50 metric
```{r}
ec50_met <- generate_ec50(cell_lines, drugs) 
```

3. E inf metric
```{r}
einf_met <- generate_e_inf(cell_lines, drugs)
```

Or the user can create full response data with one function:

```{r eval=FALSE}
response_data <- prepareMergedData(cell_lines, drugs)
head(response_data)
```


**SUMMARY**

| Step | Function     | Output (`data.table`) |
| :--: | :----------- | :-------------------- |
| 0    | create_synthetic_cell_lines() | synthetic cell lines |
| 0    | create_synthetic_drugs()      | synthetic drugs |
| 1    | prepareData()                 | cell lines and drug merged with replicates and concentration |
| 2    | prepareMergedData()           | full response data for single-agent |
| 2    | prepareComboMergedData()      | full response data for combo |
| 2    | prepareCodilutionData ()      | full response data for co-dilution |

## Synthetic object of gDR data model

The gDR data model is built on the MultiAssayExperiments (MAE) structure. Detailed description of gDR data model may be found in gDRcore package vignette. 

In `inst/testdata` the user may find a set of `qs` file that are example of gDR data model for different data type. In file `synthetic_list.yml` maybe be found list of these datasets. Currently available are: 
```{r echo=FALSE}
yml_path <- system.file(package = "gDRtestData", "testdata", "synthetic_list.yml")
cat(paste0(names(yaml::read_yaml(yml_path)), collapse = ", \n"), ".")
```

The script `generate_example_data.R` which is showing how to generate and process above mentioned datasets is in `inst/scripts` dir.
All key functions may be found in package `gDRcore` in script `generate_wrappers.R`. 

## Annotation data

In `inst/annotation_data` the user may find `csv` files that are used in `gDRcore` for testing annotation functions.

## Other

Other files which were not mentioned above are used for testing gDR suite functionality.

# SessionInfo {-}

```{r sessionInfo}
sessionInfo()
```
